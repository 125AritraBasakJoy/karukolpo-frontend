<div class="admin-layout">
    <!-- Mobile Backdrop -->
    <div class="mobile-backdrop" [class.active]="mobileMenuOpen()" (click)="closeMobileMenu()"></div>

    <!-- Sidebar -->
    <aside class="sidebar" [class.collapsed]="sidebarCollapsed() && !isMobile()" [class.mobile-open]="mobileMenuOpen()">


        <!-- Navigation Menu -->
        <nav class="nav-menu">
            <div *ngFor="let section of getMenuSections()" class="menu-section">
                <div class="menu-section-header" *ngIf="!sidebarCollapsed() || isMobile()"
                    (click)="toggleSection(section)">
                    <span class="menu-section-title">{{ section }}</span>
                    <i class="pi" [ngClass]="isSectionExpanded(section) ? 'pi-chevron-down' : 'pi-chevron-right'"></i>
                </div>

                <div class="menu-section-content"
                    [class.expanded]="isSectionExpanded(section) || (sidebarCollapsed() && !isMobile())">
                    <a *ngFor="let item of getItemsBySection(section)" [routerLink]="item.route" class="menu-item"
                        [class.active]="isActiveRoute(item.route)" (click)="closeMobileMenu()">
                        <i [class]="item.icon + ' menu-icon'"></i>
                        <span class="menu-label">{{ item.label }}</span>
                    </a>
                </div>
            </div>
        </nav>

        <!-- Sidebar Footer -->
        <div class="sidebar-footer">
            <!-- Theme Toggle Removed -->
            <!-- <button pButton ... > ... </button> -->
            <button pButton [label]="(sidebarCollapsed() && !isMobile()) ? '' : 'Logout'" icon="pi pi-sign-out"
                (click)="logout()" class="p-button-danger w-full"
                [pTooltip]="(sidebarCollapsed() && !isMobile()) ? 'Logout' : ''" tooltipPosition="right"></button>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="content">
        <!-- Content Header -->
        <header class="content-header">
            <div class="logo mr-3" style="height: 40px; display: flex; align-items: center;">
                <img src="assets/logo.png" alt="Karukolpo Logo" class="logo-img"
                    style="height: 40px; width: auto; object-fit: contain;" />
            </div>

            <button pButton type="button" icon="pi pi-bars" class="p-button-text p-button-rounded mobile-toggle-btn"
                (click)="toggleSidebar()"></button>

            <button pButton type="button" [icon]="sidebarCollapsed() ? 'pi pi-angle-right' : 'pi pi-angle-left'"
                class="p-button-text p-button-rounded desktop-toggle-btn" (click)="toggleSidebar()"
                pTooltip="Toggle Sidebar"></button>

            <div class="breadcrumb">
                <i class="pi pi-home"></i> / {{ getBreadcrumb() }}
            </div>

            <div style="margin-left: auto;">
                <span class="text-sm text-color-secondary">Admin Panel</span>
            </div>
        </header>

        <!-- Content Body -->
        <main class="content-body">
            <router-outlet></router-outlet>
        </main>
    </div>

    <!-- Toast Notifications -->
    <p-toast position="top-right"></p-toast>
</div>